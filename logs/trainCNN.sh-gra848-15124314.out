Python 3.5.4
2019-05-23 20:03:18.650862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
totalMemory: 11.91GiB freeMemory: 11.63GiB
2019-05-23 20:03:18.651018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-05-23 20:03:20.207066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-05-23 20:03:20.207230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-05-23 20:03:20.207281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-05-23 20:03:20.207696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11251 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-05-23 20:03:20.208316: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
trn path: ../PreprocessedData/preprocessedForCNN/224x224/imgData_(224, 224, 3)_train_n1000.npy
data augmentation: False
debugging mode: ON
default
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 224, 224, 3)       0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 25088)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               12845568  
_________________________________________________________________
dense_2 (Dense)              (None, 512)               262656    
_________________________________________________________________
dense_3 (Dense)              (None, 4)                 2052      
=================================================================
Total params: 27,824,964
Trainable params: 13,110,276
Non-trainable params: 14,714,688
_________________________________________________________________
None
Train on 20 samples, validate on 20 samples
Epoch 1/3

 2/20 [==>...........................] - ETA: 24s - loss: 1.7398 - acc: 0.5000 - categorical_crossentropy: 1.7398
 8/20 [===========>..................] - ETA: 4s - loss: 1.3715 - acc: 0.5000 - categorical_crossentropy: 1.3715 
14/20 [====================>.........] - ETA: 1s - loss: 1.1581 - acc: 0.4286 - categorical_crossentropy: 1.1581
20/20 [==============================] - 3s 155ms/step - loss: 1.6705 - acc: 0.3500 - categorical_crossentropy: 1.6705 - val_loss: 2.3369 - val_acc: 0.4500 - val_categorical_crossentropy: 2.3369
Epoch 2/3

 2/20 [==>...........................] - ETA: 0s - loss: 1.2311 - acc: 0.5000 - categorical_crossentropy: 1.2311
 8/20 [===========>..................] - ETA: 0s - loss: 0.7045 - acc: 0.7500 - categorical_crossentropy: 0.7045
14/20 [====================>.........] - ETA: 0s - loss: 0.7772 - acc: 0.7143 - categorical_crossentropy: 0.7772
20/20 [==============================] - 0s 15ms/step - loss: 0.9114 - acc: 0.6500 - categorical_crossentropy: 0.9114 - val_loss: 1.8608 - val_acc: 0.2000 - val_categorical_crossentropy: 1.8608
Epoch 3/3

 2/20 [==>...........................] - ETA: 0s - loss: 0.6590 - acc: 0.5000 - categorical_crossentropy: 0.6590
 8/20 [===========>..................] - ETA: 0s - loss: 0.7863 - acc: 0.6250 - categorical_crossentropy: 0.7863
14/20 [====================>.........] - ETA: 0s - loss: 0.6130 - acc: 0.7143 - categorical_crossentropy: 0.6130
20/20 [==============================] - 0s 15ms/step - loss: 0.5902 - acc: 0.7500 - categorical_crossentropy: 0.5902 - val_loss: 1.5792 - val_acc: 0.3500 - val_categorical_crossentropy: 1.5792
training time: 0.00209070536825392 h
running model pred on test set

20/20 [==============================] - 1s 40ms/step
Using TensorFlow backend.
Done!
